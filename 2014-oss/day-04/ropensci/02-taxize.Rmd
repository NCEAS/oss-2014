---
title: Resolving taxonomic names using Taxize
author: Karthik Ram
output:
  pdf_document:
    toc: false
    highlight: default
---  

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  comment = " ",
  error = FALSE,
  tidy = FALSE
)
```


```{r use-case}
library(taxize)
temp <- gnr_resolve(names = c("Helianthos annus", "Homo saapiens"))
temp$results[ , -c(1,4)]
```


```{r tnrs}
mynames <- c("Helianthus annuus", "Pinus contort", "Poa anua", "Abis magnifica",
    "Rosa california", "Festuca arundinace", "Sorbus occidentalos","Madia sateva")
tnrs(query = mynames, source = "iPlant_TNRS")[ , -c(5:7)]
```

# Retrieve higher taxonomic names

Another task biologists often face is getting higher taxonomic names for a taxa list. Having the higher taxonomy allows you to put into context the relationships of your species list. For example, you may find out that species A and species B are in Family C, which may lead to some interesting insight, as opposed to not knowing that Species A and B are closely related. This also makes it easy to aggregate/standardize data to a specific taxonomic level (e.g., family level) or to match data to other databases with different taxonomic resolution (e.g., trait databases).

```{r tax_names}
specieslist <- c("Abies procera","Pinus contorta")
classification(specieslist, db = 'itis')
```

It turns out both species are in the family Pinaceae. You can also get this type of information from the NCBI by doing classification(specieslist, db = 'ncbi').
Instead of a full classification, you may only want a single name, say a family name for your species of interest. The function *tax_name} is built just for this purpose. As with the classification function you can specify the data source with the db argument, either ITIS or NCBI.

```{r family_name}
tax_name(query = "Helianthus annuus", get = "family", db = "ncbi")
```


# What taxa are the children of my taxon of interest?

If someone is not a taxonomic specialist on a particular taxon he likely does not know what children taxa are within a family, or within a genus. This task becomes especially unwieldy when there are a large number of taxa downstream. You can of course go to a website like Wikispecies or Encyclopedia of Life to get downstream names. However, taxize provides an easy way to programatically search for downstream taxa, both for the Catalogue of Life (CoL) and the Integrated Taxonomic Information System. Here is a short example using the CoL in which we want to find all the species within the genus Apis (honey bees).

```{r children}
col_downstream(name = "Apis", downto = "Species")
```